@model Workshop1.Models.ViewModels.CourseEditVM

@{
    ViewData["Title"] = "Edit Course";
}

<h1>Edit</h1>
<h4>Course</h4>
<hr />

<form asp-action="Edit" method="post">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
    <input type="hidden" asp-for="Id" />

    <div class="row">
        <div class="col-md-6">

            <div class="form-group mb-2">
                <label asp-for="Title" class="control-label"></label>
                <input asp-for="Title" class="form-control" />
                <span asp-validation-for="Title" class="text-danger"></span>
            </div>

            <div class="form-group mb-2">
                <label asp-for="Credits" class="control-label"></label>
                <input asp-for="Credits" class="form-control" />
                <span asp-validation-for="Credits" class="text-danger"></span>
            </div>

            <div class="form-group mb-2">
                <label asp-for="Semester" class="control-label"></label>
                <input asp-for="Semester" class="form-control" />
                <span asp-validation-for="Semester" class="text-danger"></span>
            </div>

            <div class="form-group mb-2">
                <label asp-for="Programme" class="control-label"></label>
                <input asp-for="Programme" class="form-control" />
                <span asp-validation-for="Programme" class="text-danger"></span>
            </div>

            <div class="form-group mb-2">
                <label asp-for="EducationLevel" class="control-label"></label>
                <input asp-for="EducationLevel" class="form-control" />
                <span asp-validation-for="EducationLevel" class="text-danger"></span>
            </div>

            <div class="form-group mb-2">
                <label class="control-label">First Teacher</label>
                <select asp-for="FirstTeacherId" class="form-select" asp-items="Model.Teachers">
                    <option value="">-- none --</option>
                </select>
            </div>

            <div class="form-group mb-3">
                <label class="control-label">Second Teacher</label>
                <select asp-for="SecondTeacherId" class="form-select" asp-items="Model.Teachers">
                    <option value="">-- none --</option>
                </select>
            </div>

        </div>

        <div class="col-md-6">
            <h5>Enroll students</h5>

            <div style="max-height: 260px; overflow:auto; border: 1px solid #ddd; padding:10px; border-radius:6px;">
                @foreach (var s in Model.AllStudents)
                {
                    var sid = long.Parse(s.Value);
                    var isChecked = Model.SelectedStudentIds.Contains(sid);

                    <div class="form-check">
                        <input class="form-check-input"
                               type="checkbox"
                               name="SelectedStudentIds"
                               value="@s.Value"
                               @(isChecked ? "checked" : "") />
                        <label class="form-check-label">@s.Text</label>
                    </div>
                }
            </div>
        </div>
    </div>

    <hr />
    <h5>Enrollment details</h5>

    <div class="table-responsive">
        <table class="table table-striped align-middle">
            <thead>
                <tr>
                    <th>Student</th>
                    <th>Semester</th>
                    <th>Year</th>
                    <th>Grade</th>
                    <th>Exam</th>
                    <th>Seminar</th>
                    <th>Project</th>
                    <th>Add.</th>
                    <th>Seminar URL</th>
                    <th>Project URL</th>
                    <th>Finish</th>
                </tr>
            </thead>
            <tbody>
                @for (int i = 0; i < Model.EnrollmentRows.Count; i++)
                {
                    <tr>
                        <td style="min-width:220px;">
                            @Model.EnrollmentRows[i].StudentDisplay

                            <input type="hidden" asp-for="EnrollmentRows[i].Id" />
                            <input type="hidden" asp-for="EnrollmentRows[i].StudentId" />
                            <input type="hidden" asp-for="EnrollmentRows[i].StudentDisplay" />
                        </td>

                        <td style="min-width:120px;">
                            <input class="form-control" asp-for="EnrollmentRows[i].Semester" />
                        </td>

                        <td style="min-width:90px;">
                            <input class="form-control" asp-for="EnrollmentRows[i].Year" />
                        </td>

                        <td style="min-width:90px;">
                            <input class="form-control" asp-for="EnrollmentRows[i].Grade" />
                        </td>

                        <td style="min-width:90px;">
                            <input class="form-control" asp-for="EnrollmentRows[i].ExamPoints" />
                        </td>

                        <td style="min-width:90px;">
                            <input class="form-control" asp-for="EnrollmentRows[i].SeminarPoints" />
                        </td>

                        <td style="min-width:90px;">
                            <input class="form-control" asp-for="EnrollmentRows[i].ProjectPoints" />
                        </td>

                        <td style="min-width:90px;">
                            <input class="form-control" asp-for="EnrollmentRows[i].AdditionalPoints" />
                        </td>

                        <td style="min-width:220px;">
                            <input class="form-control" asp-for="EnrollmentRows[i].SeminarUrl" />
                        </td>

                        <td style="min-width:220px;">
                            <input class="form-control" asp-for="EnrollmentRows[i].ProjectUrl" />
                        </td>

                        <td style="min-width:140px;">
                            <input class="form-control" type="date" asp-for="EnrollmentRows[i].FinishDate" />
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <div class="mt-3">
        <input type="submit" value="Save" class="btn btn-primary" />
        <a asp-action="Index" class="btn btn-outline-secondary">Back to List</a>
    </div>
</form>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
