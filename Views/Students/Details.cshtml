@model Workshop1.Models.Student

@{
    ViewData["Title"] = "Student Details";
}

<div class="container py-4">
    <!-- Header Section -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="display-6 fw-bold" style="color: var(--primary-color);">Student Details</h1>
        </div>
        @if (User.IsInRole("Admin"))
        {
            <div>
                <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary me-2">
                <i class="fas fa-edit me-1"></i>Edit Student
            </a>
            <a asp-action="Index" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left me-1"></i>Back to List
            </a>
        </div>
        }
    </div>

    <!-- Student Information Card -->
    <div class="row g-4">
        <!-- Left Column: Student Info -->
        <div class="col-lg-8">
            <div class="card shadow-sm border-0">
                <div class="card-header bg-white border-0 py-3">
                    <h5 class="card-title mb-0 fw-semibold">
                        <i class="fas fa-user-graduate me-2" style="color: var(--primary-color);"></i>
                        Student Information
                    </h5>
                </div>
                <div class="card-body p-4">
                    <div class="row">
                        <div class="col-md-6">
                            <dl class="row mb-0">
                                <dt class="col-sm-5 text-muted fw-medium">Student ID</dt>
                                <dd class="col-sm-7 fw-semibold">@Model.StudentId</dd>

                                <dt class="col-sm-5 text-muted fw-medium mt-2">First Name</dt>
                                <dd class="col-sm-7 mt-2">
                                    <div class="d-flex align-items-center">
                                        <div class="info-icon me-2">
                                            <i class="fas fa-user" style="color: var(--primary-color);"></i>
                                        </div>
                                        @Model.FirstName
                                    </div>
                                </dd>

                                <dt class="col-sm-5 text-muted fw-medium mt-2">Last Name</dt>
                                <dd class="col-sm-7 mt-2">
                                    <div class="d-flex align-items-center">
                                        <div class="info-icon me-2">
                                            <i class="fas fa-user" style="color: var(--primary-color);"></i>
                                        </div>
                                        @Model.LastName
                                    </div>
                                </dd>

                                <dt class="col-sm-5 text-muted fw-medium mt-2">Enrollment Date</dt>
                                <dd class="col-sm-7 mt-2">
                                    <div class="d-flex align-items-center">
                                        <div class="info-icon me-2">
                                            <i class="fas fa-calendar-plus" style="color: var(--secondary-color);"></i>
                                        </div>
                                        @(Model.EnrollmentDate.HasValue
                                                                                ? Model.EnrollmentDate.Value.ToString("yyyy-MM-dd")
                                                                                : "-")
                                    </div>
                                </dd>
                            </dl>
                        </div>

                        <div class="col-md-6">
                            <dl class="row mb-0">
                                <dt class="col-sm-5 text-muted fw-medium">Acquired Credits</dt>
                                <dd class="col-sm-7">
                                    <div class="d-flex align-items-center">
                                        <div class="info-icon me-2">
                                            <i class="fas fa-star" style="color: #f59e0b;"></i>
                                        </div>
                                        <span class="badge rounded-pill"
                                              style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.2));
                                                     color: #f59e0b; padding: 0.25rem 0.75rem;">
                                            @Model.AcquiredCredits
                                        </span>
                                    </div>
                                </dd>

                                <dt class="col-sm-5 text-muted fw-medium mt-2">Current Semester</dt>
                                <dd class="col-sm-7 mt-2">
                                    <div class="d-flex align-items-center">
                                        <div class="info-icon me-2">
                                            <i class="fas fa-graduation-cap" style="color: var(--secondary-color);"></i>
                                        </div>
                                        <span class="badge rounded-pill"
                                              style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.2));
                                                     color: var(--secondary-color); padding: 0.25rem 0.75rem;">
                                            @Model.CurrentSemester
                                        </span>
                                    </div>
                                </dd>

                                <dt class="col-sm-5 text-muted fw-medium mt-2">Education Level</dt>
                                <dd class="col-sm-7 mt-2">
                                    <div class="d-flex align-items-center">
                                        <div class="info-icon me-2">
                                            <i class="fas fa-university" style="color: #9333ea;"></i>
                                        </div>
                                        @Model.EducationLevel
                                    </div>
                                </dd>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column: Profile Image -->
        <div class="col-lg-4">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-header bg-white border-0 py-3">
                    <h5 class="card-title mb-0 fw-semibold">
                        <i class="fas fa-id-card me-2" style="color: var(--primary-color);"></i>
                        Profile Image
                    </h5>
                </div>
                <div class="card-body p-4 d-flex flex-column justify-content-center align-items-center">
                    @if (!string.IsNullOrWhiteSpace(Model.ProfileImagePath))
                    {
                        <div class="profile-image-container mb-3">
                            <img src="@Model.ProfileImagePath"
                                 alt="Student profile image"
                                 class="profile-image rounded-3 shadow-sm"
                                 style="max-width: 100%; border: 4px solid var(--primary-color);" />
                            <div class="profile-image-overlay">
                                <i class="fas fa-user-graduate fa-2x text-white"></i>
                            </div>
                        </div>

                        @if (User.IsInRole("Student"))
                        {
                            <hr class="w-100 my-3" />

                            <form asp-action="UploadProfileImage" method="post" enctype="multipart/form-data" class="w-100">
                                @Html.AntiForgeryToken()

                                <div class="mb-2">
                                    <label class="form-label fw-medium">
                                        <i class="fas fa-image me-1" style="color: var(--secondary-color);"></i>
                                        @(string.IsNullOrWhiteSpace(Model.ProfileImagePath) ? "Upload image" : "Change image")
                                    </label>

                                    <input type="file" name="profileImage" class="form-control" accept="image/*" />
                                </div>

                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fas fa-save me-1"></i> Save
                                </button>
                            </form>
                        }
                    }
                    else
                    {
                        <div class="no-image-placeholder rounded-3 d-flex align-items-center justify-content-center mb-3"
                             style="width: 200px; height: 200px; background: linear-gradient(135deg, rgba(79, 70, 229, 0.1), rgba(79, 70, 229, 0.2));">
                            <i class="fas fa-user-graduate fa-4x" style="color: var(--primary-color);"></i>
                        </div>
                        <p class="text-muted small text-center">
                            <i class="fas fa-info-circle me-1"></i>
                            No profile image uploaded
                        </p>

                        @if (User.IsInRole("Student"))
                        {
                            <hr class="w-100 my-3" />

                            @if (TempData["Success"] != null)
                            {
                                <div class="alert alert-success w-100 text-center mb-2">
                                    @TempData["Success"]
                                </div>
                            }
                            @if (TempData["Error"] != null)
                            {
                                <div class="alert alert-danger w-100 text-center mb-2">
                                    @TempData["Error"]
                                </div>
                            }

                            <form asp-action="UploadProfileImage" method="post" enctype="multipart/form-data" class="w-100">
                                @Html.AntiForgeryToken()

                                <div class="mb-2">
                                    <label class="form-label fw-medium">
                                        <i class="fas fa-upload me-1" style="color: var(--secondary-color);"></i>
                                        Upload image
                                    </label>
                                    <input type="file" name="profileImage" class="form-control" accept="image/*" />
                                </div>

                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fas fa-save me-1"></i> Save
                                </button>
                            </form>
                        }

                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Stats Section -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card shadow-sm border-0">
                <div class="card-header bg-white border-0 py-3">
                    <h5 class="card-title mb-0 fw-semibold">
                        <i class="fas fa-chart-bar me-2" style="color: var(--primary-color);"></i>
                        Student Statistics
                    </h5>
                </div>
                <div class="card-body p-4">
                    <div class="row text-center">
                        <div class="col-md-3 mb-3">
                            <div class="stat-circle mx-auto mb-2 d-flex align-items-center justify-content-center"
                                 style="width: 70px; height: 70px; background: linear-gradient(135deg, rgba(79, 70, 229, 0.1), rgba(79, 70, 229, 0.2)); border-radius: 50%;">
                                <i class="fas fa-star" style="color: var(--primary-color); font-size: 1.8rem;"></i>
                            </div>
                            <div class="stat-number fw-bold fs-4" style="color: var(--primary-color);">@Model.AcquiredCredits</div>
                            <div class="stat-label text-muted small">Credits Acquired</div>
                        </div>

                        <div class="col-md-3 mb-3">
                            <div class="stat-circle mx-auto mb-2 d-flex align-items-center justify-content-center"
                                 style="width: 70px; height: 70px; background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.2)); border-radius: 50%;">
                                <i class="fas fa-graduation-cap" style="color: var(--secondary-color); font-size: 1.8rem;"></i>
                            </div>
                            <div class="stat-number fw-bold fs-4" style="color: var(--secondary-color);">@Model.CurrentSemester</div>
                            <div class="stat-label text-muted small">Current Semester</div>
                        </div>

                        <div class="col-md-3 mb-3">
                            <div class="stat-circle mx-auto mb-2 d-flex align-items-center justify-content-center"
                                 style="width: 70px; height: 70px; background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.2)); border-radius: 50%;">
                                <i class="fas fa-calendar-alt" style="color: #f59e0b; font-size: 1.8rem;"></i>
                            </div>
                            <div class="stat-number fw-bold fs-4" style="color: #f59e0b;">
                                @{
                                    var enrollmentYears = Model.EnrollmentDate.HasValue
                                    ? Math.Max(0, DateTime.Now.Year - Model.EnrollmentDate.Value.Year)
                                    : 0;
                                }
                                @enrollmentYears
                            </div>
                            <div class="stat-label text-muted small">Years Enrolled</div>
                        </div>

                        <div class="col-md-3 mb-3">
                            <div class="stat-circle mx-auto mb-2 d-flex align-items-center justify-content-center"
                                 style="width: 70px; height: 70px; background: linear-gradient(135deg, rgba(147, 51, 234, 0.1), rgba(147, 51, 234, 0.2)); border-radius: 50%;">
                                <i class="fas fa-user-graduate" style="color: #9333ea; font-size: 1.8rem;"></i>
                            </div>
                            <div class="stat-number fw-bold fs-4" style="color: #9333ea;">
                                @Model.EducationLevel
                            </div>
                            <div class="stat-label text-muted small">Education Level</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    @if (User.IsInRole("Admin"))
    {
        <div class="mt-4 pt-3 border-top">
            <div class="d-flex justify-content-between">
                <a asp-action="Index" class="btn btn-outline-secondary">
                    <i class="fas fa-list me-1"></i>View All Students
                </a>
                <div>
                    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary me-2">
                        <i class="fas fa-edit me-1"></i>Edit Student
                    </a>
                    <a asp-action="Index" class="btn btn-outline-primary">
                        <i class="fas fa-home me-1"></i>Back to Dashboard
                    </a>
                </div>
            </div>
        </div>
    }
</div>

<style>
    .card {
        border-radius: 12px;
        border: 1px solid rgba(0,0,0,0.05);
    }

    .card-header {
        border-bottom: 1px solid rgba(0,0,0,0.05);
    }

    .info-icon {
        width: 30px;
        height: 30px;
        background: rgba(79,70,229,0.1);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
    }

    .profile-image-container {
        position: relative;
        display: inline-block;
    }

    .profile-image {
        transition: transform 0.3s ease;
        max-width: 250px;
    }

        .profile-image:hover {
            transform: scale(1.05);
        }

    .profile-image-overlay {
        position: absolute;
        inset: 0;
        background: rgba(79,70,229,0.1);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .profile-image-container:hover .profile-image-overlay {
        opacity: 1;
    }

    .stat-circle {
        transition: transform 0.3s ease;
    }

        .stat-circle:hover {
            transform: scale(1.1);
        }

    .badge {
        font-weight: 500;
    }

    .no-image-placeholder {
        transition: transform 0.3s ease;
    }

        .no-image-placeholder:hover {
            transform: scale(1.05);
        }

    @@media (max-width: 768px) {
        .d-flex.justify-content-between.align-items-center {
            flex-direction: column;
            align-items: flex-start !important;
            gap: 1rem;
        }

        .d-flex.justify-content-between {
            flex-direction: column;
            gap: 1rem;
        }

            .d-flex.justify-content-between > div {
                width: 100%;
            }

            .d-flex.justify-content-between .btn {
                width: 100%;
                margin-bottom: 0.5rem;
            }
    }
</style>
